# æ•°æ®åº“è¿ç§»è¯´æ˜

## ğŸ“ æ–‡ä»¶ç»“æ„

### å½“å‰ä½¿ç”¨çš„åˆå§‹åŒ–æ–‡ä»¶
- **`000_init_database.sql`** - å®Œæ•´çš„æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆæ¨èä½¿ç”¨ï¼‰
  - åŒ…å«æ‰€æœ‰è¡¨ç»“æ„
  - åŒ…å«æ‰€æœ‰ç´¢å¼•
  - åŒ…å«è§¦å‘å™¨
  - åŒ…å«é»˜è®¤ç®¡ç†å‘˜è´¦å·


### å·¥å…·è„šæœ¬
- `migrator.js` - è¿ç§»æ‰§è¡Œå™¨
- `reset_admin_password.js` - é‡ç½®ç®¡ç†å‘˜å¯†ç è„šæœ¬

## ğŸš€ ä½¿ç”¨æ–¹å¼

### å…¨æ–°éƒ¨ç½²
ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰§è¡Œ `000_init_database.sql`ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚

### æ•°æ®åº“ç»“æ„

#### 1. usersï¼ˆç”¨æˆ·è¡¨ï¼‰
- `id` - ä¸»é”®
- `name` - ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
- `email` - é‚®ç®±
- `password` - å¯†ç ï¼ˆåŠ å¯†ï¼‰
- `role` - è§’è‰²ï¼ˆadmin/userï¼‰
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

#### 2. fundsï¼ˆèµ„é‡‘è¡¨ - æµæ°´æ¨¡å¼ï¼‰
- `id` - ä¸»é”®
- `user_id` - ç”¨æˆ·ID
- `amount` - é‡‘é¢
- `timestamp` - æ—¶é—´æˆ³

#### 3. fund_logsï¼ˆèµ„é‡‘æ—¥å¿—è¡¨ï¼‰
- `id` - ä¸»é”®
- `user_id` - ç”¨æˆ·ID
- `type` - ç±»å‹ï¼ˆdeposit/withdrawï¼‰
- `amount` - é‡‘é¢
- `balance_after` - æ“ä½œåä½™é¢
- `remark` - å¤‡æ³¨
- `timestamp` - æ—¶é—´æˆ³

#### 4. positionsï¼ˆæŒä»“è¡¨ï¼‰
- `id` - ä¸»é”®
- `user_id` - ç”¨æˆ·ID
- `asset_type` - èµ„äº§ç±»å‹ï¼ˆstock/futureï¼‰
- `code` - ä»£ç 
- `name` - åç§°
- `operation` - æ“ä½œï¼ˆbuy/sellï¼‰
- `price` - ä»·æ ¼
- `quantity` - æ•°é‡
- `timestamp` - æ—¶é—´æˆ³
- `fee` - æ‰‹ç»­è´¹

#### 5. price_dataï¼ˆä»·æ ¼æ•°æ®è¡¨ï¼‰
- `code` - ä»£ç 
- `asset_type` - èµ„äº§ç±»å‹
- `current_price` - å½“å‰ä»·æ ¼
- `timestamp` - æ—¶é—´æˆ³

## ğŸ” é»˜è®¤ç®¡ç†å‘˜è´¦å·

é¦–æ¬¡éƒ¨ç½²åä¼šè‡ªåŠ¨åˆ›å»ºï¼š
- **ç”¨æˆ·å**ï¼šadmin
- **å¯†ç **ï¼šadmin
- **é‚®ç®±**ï¼šadmin@example.com
- **è§’è‰²**ï¼šç®¡ç†å‘˜

âš ï¸ **é‡è¦**ï¼šé¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼

## ğŸ› ï¸ å¸¸ç”¨æ“ä½œ

### é‡ç½®ç®¡ç†å‘˜å¯†ç 
```bash
docker-compose exec backend node migrations/reset_admin_password.js
```

### æ‰‹åŠ¨åˆ›å»ºç®¡ç†å‘˜
```bash
docker-compose exec backend node migrations/create_admin.js
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ä¸è¦åˆ é™¤ `000_init_database.sql`** - è¿™æ˜¯å…¨æ–°éƒ¨ç½²çš„æ ¸å¿ƒæ–‡ä»¶
2. **ä¸è¦ä¿®æ”¹ `_archived/` ç›®å½•** - ä»…ä¾›å†å²å‚è€ƒ
3. **æ–°çš„è¿ç§»æ–‡ä»¶** - å¦‚éœ€æ·»åŠ æ–°åŠŸèƒ½ï¼Œåˆ›å»ºæ–°çš„è¿ç§»æ–‡ä»¶ï¼ˆå¦‚ `007_xxx.sql`ï¼‰
4. **è¿ç§»é¡ºåº** - è¿ç§»æ–‡ä»¶æŒ‰æ–‡ä»¶åæ’åºæ‰§è¡Œ
5. **å¹‚ç­‰æ€§** - æ‰€æœ‰ SQL è¯­å¥éƒ½ä½¿ç”¨ `IF NOT EXISTS` æˆ– `OR IGNORE` ç¡®ä¿å¯é‡å¤æ‰§è¡Œ

## ğŸ”„ è¿ç§»æœºåˆ¶

ç³»ç»Ÿä½¿ç”¨ `migrator.js` è‡ªåŠ¨ç®¡ç†è¿ç§»ï¼š
- âœ… è‡ªåŠ¨æ£€æµ‹æœªæ‰§è¡Œçš„è¿ç§»
- âœ… æŒ‰é¡ºåºæ‰§è¡Œè¿ç§»æ–‡ä»¶
- âœ… è®°å½•å·²æ‰§è¡Œçš„è¿ç§»
- âœ… äº‹åŠ¡ä¿æŠ¤ï¼Œå¤±è´¥è‡ªåŠ¨å›æ»š
- âœ… æ”¯æŒå¤æ‚ SQLï¼ˆè§¦å‘å™¨ã€å‡½æ•°ç­‰ï¼‰

## ğŸ“š æ›´å¤šä¿¡æ¯

æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£ï¼š
- [éƒ¨ç½²æŒ‡å—](../../docs/deployment.md)
- [Docker éƒ¨ç½²](../../docs/DOCKER_DEPLOYMENT.md)
- [ç¯å¢ƒå˜é‡](../../docs/ENVIRONMENT_VARIABLES.md)
